interface IDatabaseRepository<T>
{

    public IEnumerable<T> Read(int limit)
    {
        string path = "chirp_cli_db.csv"; // Path to your CSV file
        using var reader = new StreamReader(path);

        using var csv = new CsvReader(reader, CultureInfo.InvariantCulture);
            try
            {
                var records = csv.GetRecords<Cheep>().Take(limit);
                foreach (var Cheep in records)
                {
                    Cheep.Display();
                }

            }
            catch (Exception ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
            }

    }

    public void Store(T record)
     {
        string path = "chirp_cli_db.csv"; // Path to your CSV file

            string author = "CLI User"; // Default author for CLI entries
            long timestamp = DateTimeOffset.Now.ToUnixTimeSeconds();

            var cheep = new Cheep
            {
                Author = author,
                Record = record,
                Timestamp = timestamp
            };

            using var stream = new StreamWriter(path, append: true);
            using var csv = new CsvWriter(stream, new CsvConfiguration(CultureInfo.InvariantCulture)
            {
                HasHeaderRecord = false
            });

            try
            {
                csv.WriteRecord(cheep);
                csv.NextRecord();
                Console.WriteLine("Record successfully added!");
            }
            catch (Exception e)
            {
                Console.WriteLine($"An error occurred while adding the cheep: {e.Message}");
            }
    }
}
